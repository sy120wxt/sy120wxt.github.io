require=function t(e,i,o){function s(c,r){if(!i[c]){if(!e[c]){var h="function"==typeof require&&require;if(!r&&h)return h(c,!0);if(n)return n(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var p=i[c]={exports:{}};e[c][0].call(p.exports,function(t){var i=e[c][1][t];return s(i||t)},p,p.exports,t,e,i,o)}return i[c].exports}for(var n="function"==typeof require&&require,c=0;c<o.length;c++)s(o[c]);return s}({GAME:[function(t,e,i){"use strict";cc._RF.push(e,"719d8UXjBZMj6Nk+urktQey","GAME");var o=cc.Enum({PREPARE:-1,PLAY:-1,DEAD:-1,WIN:-1}),s=cc.Enum({BLANK:-1,FLAG:-1});cc.Class({extends:cc.Component,properties:{tilesLayout:cc.Node,tile:cc.Prefab,btnShow:cc.Node,tiles:[],picPrepare:cc.SpriteFrame,picPlay:cc.SpriteFrame,picDead:cc.SpriteFrame,picWin:cc.SpriteFrame,gameState:{default:o.PREPARE,type:o},touchState:{default:s.BLANK,type:s},row:0,col:0,bombNum:0,Score:cc.Node,Time:cc.Node},onLoad:function(){this.Tile=t("Tile"),this.roundClear=!1,this.alreadyStarted=!1;for(var e=this,i=0;i<this.row;i++)for(var n=0;n<this.col;n++){var c=cc.instantiate(this.tile);c.tag=i*this.col+n,c.on(cc.Node.EventType.MOUSE_DOWN,function(t){t.getButton()===cc.Event.EventMouse.BUTTON_LEFT&&cc.Event.EventMouse.BUTTON_RIGHT&&(e.roundClear=e.openNum(this))}),c.on(cc.Node.EventType.MOUSE_UP,function(t){t.getButton()===cc.Event.EventMouse.BUTTON_LEFT?e.touchState=s.BLANK:t.getButton()===cc.Event.EventMouse.BUTTON_RIGHT&&(e.touchState=s.FLAG),e.stopWatch(o.PLAY),e.onTouchTile(this)}),this.tilesLayout.addChild(c),this.tiles.push(c)}this.newGame(),this.btnShow.on(cc.Node.EventType.MOUSE_UP,function(t){e.onBtnShow()})},newGame:function(){for(var t=0;t<this.tiles.length;t++)this.tiles[t].getComponent("Tile").type=this.Tile.TYPE.ZERO,this.tiles[t].getComponent("Tile").state=this.Tile.STATE.NONE;this.restBmob=this.bombNum,this.Score.getComponent(cc.Label).string=this.restBmob,this.time=0,this.Time.getComponent(cc.Label).string=this.time;for(var e=[],i=0;i<this.tiles.length;i++)e[i]=i;for(var s=0;s<this.bombNum;s++){var n=Math.floor(Math.random()*e.length);this.tiles[e[n]].getComponent("Tile").type=this.Tile.TYPE.BOMB,e.splice(n,1)}for(var c=0;c<this.tiles.length;c++){var r=0;if(this.tiles[c].getComponent("Tile").type==this.Tile.TYPE.ZERO){for(var h=this.tileRound(c),a=0;a<h.length;a++)h[a].getComponent("Tile").type==this.Tile.TYPE.BOMB&&r++;this.tiles[c].getComponent("Tile").type=r}}this.gameState=o.PLAY,this.btnShow.getComponent(cc.Sprite).spriteFrame=this.picPlay},tileRound:function(t){var e=[];return t%this.col>0&&e.push(this.tiles[t-1]),t%this.col>0&&Math.floor(t/this.col)>0&&e.push(this.tiles[t-this.col-1]),t%this.col>0&&Math.floor(t/this.col)<this.row-1&&e.push(this.tiles[t+this.col-1]),Math.floor(t/this.col)>0&&e.push(this.tiles[t-this.col]),Math.floor(t/this.col)<this.row-1&&e.push(this.tiles[t+this.col]),t%this.col<this.col-1&&e.push(this.tiles[t+1]),t%this.col<this.col-1&&Math.floor(t/this.col)>0&&e.push(this.tiles[t-this.col+1]),t%this.col<this.col-1&&Math.floor(t/this.col)<this.row-1&&e.push(this.tiles[t+this.col+1]),e},onTouchTile:function(t){if(this.gameState==o.PLAY)switch(this.touchState){case s.BLANK:if(9===t.getComponent("Tile").type)return t.getComponent("Tile").state=this.Tile.STATE.CLIKED,void this.gameOver();if(t.getComponent("Tile").state===this.Tile.STATE.CLIKED){if(console.log(this.roundClear),!1===this.roundClear)for(var e=this.tileRound(t.tag),i=0;i<e.length;i++)e[i].getComponent("Tile").state===this.Tile.STATE.PRESS&&(e[i].getComponent("Tile").state=this.Tile.STATE.NONE);if(!0===this.roundClear){console.log("touchTile.Cliked");var n=t.getComponent("Tile").type,c=this.tileRound(t.tag);console.log("selfType"+n);for(var r=[],h=0;h<c.length;h++)c[h].getComponent("Tile").state===this.Tile.STATE.FLAG?n--:r.push(c[h]);var a=[];if(console.log("selfType"+n),0==n){console.log("rest = 0");for(var p=!1;r.length;){console.log("enter loop");var l=r.pop();if(l.getComponent("Tile").state=this.Tile.STATE.CLIKED,l.getComponent("Tile").type===this.Tile.TYPE.BOMB&&(p=!0),l.getComponent("Tile").type===this.Tile.TYPE.ZERO){a=this.tileRound(l.tag);for(var T=0;T<a.length;T++)a[T].getComponent("Tile").state===this.Tile.STATE.NONE&&a[T].getComponent("Tile").type===this.Tile.TYPE.ZERO?(r.push(a[T]),a[T].getComponent("Tile").state=this.Tile.STATE.CLIKED):a[T].getComponent("Tile").state=this.Tile.STATE.CLIKED}}p&&this.gameOver()}if(0!=n);}}var m=[];if(t.getComponent("Tile").state===this.Tile.STATE.NONE){for(console.log("touchTile.None"),m.push(t);m.length;){var g=m.pop();if(0===g.getComponent("Tile").type){g.getComponent("Tile").state=this.Tile.STATE.CLIKED;for(var E=this.tileRound(g.tag),u=0;u<E.length;u++)E[u].getComponent("Tile").state==this.Tile.STATE.NONE&&m.push(E[u])}else g.getComponent("Tile").type>0&&g.getComponent("Tile").type<9&&(g.getComponent("Tile").state=this.Tile.STATE.CLIKED)}this.judgeWin()}break;case s.FLAG:t.getComponent("Tile").state==this.Tile.STATE.NONE?(t.getComponent("Tile").state=this.Tile.STATE.FLAG,this.restBmob--,this.Score.getComponent(cc.Label).string=this.restBmob):t.getComponent("Tile").state==this.Tile.STATE.FLAG&&(t.getComponent("Tile").state=this.Tile.STATE.NONE)}},openNum:function(t){if(this.gameState==o.PLAY&&t.getComponent("Tile").state===this.Tile.STATE.CLIKED){var e=t.getComponent("Tile").type,i=[];i=this.tileRound(t.tag);for(var s=0;s<i.length;s++)i[s].getComponent("Tile").state===this.Tile.STATE.NONE?i[s].getComponent("Tile").state=this.Tile.STATE.PRESS:i[s].getComponent("Tile").state===this.Tile.STATE.FLAG&&e--;if(console.log(e),0===e)return!0;if(0!==e)return!1}},judgeWin:function(){for(var t=0,e=0;e<this.tiles.length;e++)this.tiles[e].getComponent("Tile").state===this.Tile.STATE.CLIKED&&t++;t===this.tiles.length-this.bombNum&&(this.gameState=o.WIN,this.btnShow.getComponent(cc.Sprite).spriteFrame=this.picWin)},gameOver:function(){this.gameState=o.DEAD,this.btnShow.getComponent(cc.Sprite).spriteFrame=this.picDead,this.stopWatch(this.gameState)},onBtnShow:function(){this.gameState===o.PREPARE&&this.newGame(),this.gameState===o.DEAD&&this.newGame(),this.gameState===o.WIN&&this.newGame()},stopWatch:function(t){this.timeup=function(){this.Time.getComponent(cc.Label).string++};var e=this;t===o.PLAY&&!1===this.alreadyStarted&&(this.alreadyStarted=!0,this.Time.getComponent(cc.Label).schedule(function(){e.timeup()},1)),t===o.DEAD&&(this.alreadyStarted=!1,console.log("stop"),this.Time.getComponent(cc.Label).unscheduleAllCallbacks())}}),cc._RF.pop()},{Tile:"Tile"}],Tile:[function(t,e,i){"use strict";cc._RF.push(e,"3120ap9E4RDZpWzNxVIqQX0","Tile");var o=cc.Enum({ZERO:0,ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,SIX:6,SEVEN:7,EIGHT:8,BOMB:9}),s=cc.Enum({NONE:-1,CLIKED:-1,FLAG:-1,DOUBT:-1,PRESS:-1});e.exports={STATE:s,TYPE:o},cc.Class({extends:cc.Component,properties:{picNone:cc.SpriteFrame,picFlag:cc.SpriteFrame,picDoubt:cc.SpriteFrame,picZero:cc.SpriteFrame,picOne:cc.SpriteFrame,picTwo:cc.SpriteFrame,picThree:cc.SpriteFrame,picFour:cc.SpriteFrame,picFive:cc.SpriteFrame,picSix:cc.SpriteFrame,picSeven:cc.SpriteFrame,picEight:cc.SpriteFrame,picBomb:cc.SpriteFrame,picPress:cc.SpriteFrame,_state:{default:s.NONE,type:s,visible:!1},state:{get:function(){return this._state},set:function(t){if(t!==this._state)switch(this._state=t,this._state){case s.NONE:this.getComponent(cc.Sprite).spriteFrame=this.picNone;break;case s.CLIKED:this.showType();break;case s.FLAG:this.getComponent(cc.Sprite).spriteFrame=this.picFlag;break;case s.DOUBT:this.getComponent(cc.Sprite).spriteFrame=this.picDoubt;break;case s.PRESS:this.getComponent(cc.Sprite).spriteFrame=this.picPress}},type:s},type:{default:o.ZERO,type:o}},showType:function(){switch(this.type){case o.ZERO:this.getComponent(cc.Sprite).spriteFrame=this.picZero;break;case o.ONE:this.getComponent(cc.Sprite).spriteFrame=this.picOne;break;case o.TWO:this.getComponent(cc.Sprite).spriteFrame=this.picTwo;break;case o.THREE:this.getComponent(cc.Sprite).spriteFrame=this.picThree;break;case o.FOUR:this.getComponent(cc.Sprite).spriteFrame=this.picFour;break;case o.FIVE:this.getComponent(cc.Sprite).spriteFrame=this.picFive;break;case o.SIX:this.getComponent(cc.Sprite).spriteFrame=this.picSix;break;case o.SEVEN:this.getComponent(cc.Sprite).spriteFrame=this.picSeven;break;case o.EIGHT:this.getComponent(cc.Sprite).spriteFrame=this.picEight;break;case o.BOMB:this.getComponent(cc.Sprite).spriteFrame=this.picBomb}}}),cc._RF.pop()},{}]},{},["GAME","Tile"]);